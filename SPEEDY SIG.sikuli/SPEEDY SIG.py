link_speedy = "http://10.226.5.211/"
user_speedy = "jsalazarq"
pass_speedy = "anovo20#"
link_inguz = "http://www.anovo.pe/inguz"
link_carga = "http://www.anovo.pe/inguz/formRutinas/frmCargarOrdenes.aspx"
user_inguz = "74590179"
pass_inguz = "jarvis"
speedySIG = r'\\10.120.15.48\CargaInguz\SpeedySIG'
delete_files = r'C:\CargaInguz\SpeedySig\*'

print("cerrar procesos")
os.system('taskkill /f /im cms.exe')
os.system('taskkill /f /im te_envot.exe')
os.system('taskkill /f /im te_banpai.exe')
os.system('taskkill /f /im te_manot.exe')
os.system('taskkill /f /im firefox.exe')
sleep(2)

print("Eliminar Archivos")
dfiles1 = glob.glob(delete_files) 
for f in dfiles1:
    os.remove(f)
sleep(2)

#*************************CARGA SPEEDY SIG***************************#
print("Abrir Firefox")
App.open("C:\\Program Files\\Mozilla Firefox\\firefox.exe")
sleep(5)

print("Pagina encontrada")
def ingresar_link():
    type("l",KEY_CTRL)
    sleep(2)
    paste(link_speedy)
    sleep(2)
    type(Key.ENTER)
    sleep(5)

ingresar_link()
ingresar_link()

print("Ingresamos login")
paste(user_speedy)
type(Key.TAB)
sleep(2)
type(Key.TAB)
paste(pass_speedy)
sleep(2)
type(Key.ENTER)
sleep(2)
wait(Pattern("1558730912222-1.png").similar(0.80),60)
sleep(5)

print("Buscamos la ruta")
click(Pattern("1558731800415-1.png").targetOffset(49,1))
sleep(2)
click(Pattern("1558731886599-1.png").targetOffset(114,1))
sleep(2)
click(Pattern("1558731962864-1.png").targetOffset(104,0))
sleep(3)
click(Pattern("1558810266863-1.png").targetOffset(93,1))
sleep(2)
click(Pattern("1558732384106-1.png").targetOffset(-28,2))
sleep(2)
type(Key.TAB*3)
sleep(2)
type(Key.DOWN)
sleep(2)
type(Key.TAB)
sleep(2)
type(Key.DOWN)
sleep(2)
click(Pattern("1558810597766-1.png").targetOffset(40,1))
sleep(2)
click(Pattern("1558810648644-1.png").targetOffset(-25,17))
sleep(2)
type(Key.TAB)
sleep(2)
type(Key.DOWN)
sleep(2)

print("Escogemos las fechas")
click(Pattern("1558811331589-1.png").targetOffset(65,-3))
sleep(2)
wait(Pattern(Pattern("1558811536469-1.png").targetOffset(-83,2)).similar(0.8),3600)
sleep(2)
click(Pattern("1558811536469-1.png").targetOffset(-81,0))
type(Key.TAB)
sleep(1)
type(Key.ENTER)
sleep(1)
click(Pattern("1558811666494-1.png").targetOffset(61,-3))
sleep(1)
wait(Pattern(Pattern("1558811807322-1.png").targetOffset(-79,2)).similar(0.8),3600)
sleep(1)
click(Pattern("1558811774668-1.png").targetOffset(13,-8))
sleep(1)
click(Pattern("1558811807322-1.png").targetOffset(-79,2))
type(Key.TAB)
type(Key.ENTER)
sleep(1)
click(Pattern("1558811868860-1.png").targetOffset(-4,-1))
sleep(5)

print("Descargar Reporte")
click(Pattern("1558811912028-2.png").targetOffset(-5,0))
wait(Pattern("1576507409167.png").similar(0.80),3600)
sleep(3)
type("l",KEY_CTRL)
sleep(2)
paste(speedySIG)
sleep(2)
type(Key.ENTER)
sleep(4)
paste(Pattern("1576507573175.png").targetOffset(28,0), "speedysig")
sleep(2)
type(Key.ENTER)
sleep(5)

print("abrir excel speedysyg")    
type("r",KeyModifier.WIN)
sleep(2)
paste("excel")
sleep(2)
type(Key.ENTER)
sleep(10)
type("q",KEY_ALT)
sleep(3)        
type("o",KEY_ALT)                
sleep(5) 
type("l",KEY_CTRL)
sleep(3) 
paste(speedySIG)
sleep(3)
type(Key.ENTER)
sleep(5)
click(Pattern("1576507945804.png").targetOffset(-24,1))
sleep(3)        
type(Key.ENTER)
sleep(10)

print("Eliminar columnas")
type(Key.LEFT)
sleep(3)        
type(Key.ENTER)
sleep(5)
click(Pattern("1558998895550-2.png").targetOffset(0,-9))
click(Pattern("1558998973798-2.png").targetOffset(7,-27))
sleep(1)
click(Pattern("1558998973798-2.png").targetOffset(7,-27))
sleep(2)

print("Guardamos el archivo")
type("g",KEY_CTRL)
sleep(2)
type(Key.RIGHT)
sleep(3)        
type(Key.ENTER)
sleep(5)
type("v",KEY_ALT)
sleep(3)        
type("o",KEY_ALT)
sleep(5)
type("l",KEY_CTRL)
sleep(3) 
paste(speedySIG)
sleep(3)
type(Key.ENTER)
sleep(5)
paste(Pattern("1558999488674-2.png").targetOffset(57,3), "speedysig")
sleep(2)
type(Key.TAB)
sleep(2)
type(Key.DOWN)
sleep(2)
type(Key.UP*4)
sleep(2)        
type(Key.ENTER)
sleep(2)
type(Key.ENTER)
sleep(5)
type(Key.LEFT)
sleep(3)        
type(Key.ENTER)
sleep(3)                
click(Pattern("1558999697604-1.png").targetOffset(44,0))
sleep(5)

print("abrir el inguz")
type("t",KEY_CTRL)
sleep(2)
type("l",KEY_CTRL)
sleep(1)
paste(link_inguz)
sleep(1)
type(Key.ENTER)
sleep(5)

print("iniciar sesion")
paste(user_inguz)
type(Key.TAB)
paste(pass_inguz)
sleep(1)
type(Key.ENTER)
sleep(5)
type("l",KEY_CTRL)
sleep(1)
paste(link_carga)
sleep(1)
type(Key.ENTER)
sleep(5)
click(Pattern("1559077079121-1.png").targetOffset(23,0))
sleep(3)
click(Pattern("1573749459036.png").targetOffset(-14,55))
sleep(3)

print("buscar el archivo")
type("l",KEY_CTRL)
sleep(2)
paste(speedySIG)
sleep(2)
type(Key.ENTER)
sleep(2)
click(Pattern("1559084566786-1.png").targetOffset(-44,0))
sleep(2)
type(Key.ENTER)
sleep(2)
click(Pattern("1573749543768.png").targetOffset(340,55))
sleep(3)
wait(Pattern("1560615777602.png").similar(0.80),240)

print("fin de la carga")
sleep(3)
type("w",KEY_CTRL)
sleep(3)